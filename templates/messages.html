{% extends "base.html" %}
{% block content %}
<div class="chat-container">

    <div class="sidebar">
        <h2>Chats</h2>
        <form action="/messages/go" method="post" style="margin-bottom: 15px;">
            <input name="receiver_id" type="number" placeholder="Enter User ID" required style="width: 100%; padding: 8px;">
            <button type="submit" style="margin-top: 5px; width: 100%;">Open Chat</button>
        </form>

        {% if conversations %}
            {% for convo in conversations %}
                <a href="/messages/{{ convo.id }}" class="contact {% if convo.id == receiver_id %}active{% endif %}">
                    {{ convo.username }}
                </a>
            {% endfor %}
        {% else %}
            <p>No conversations</p>
        {% endif %}
    </div>

    <div class="chat-panel">
        {% if messages %}
        <div class="chat-messages" id="messages">
            {% for msg in messages %}
                <div class="msg {{ 'right' if msg.sender_id == user_id else 'left' }}">
                    {{ msg.text }}
                    <div class="time">{{ msg.created_at }}</div>
                </div>
            {% endfor %}
        </div>

        <form action="/messages/create" method="post" class="chat-form">
            <input type="text" name="text" placeholder="Type a message..." required>
            <input type="hidden" name="sender_id" value="{{ user_id }}">
            <input type="hidden" name="receiver_id" value="{{ receiver_id }}">
            <input type="hidden" name="created_at" value="2025-05-11">
            <button>Send</button>
        </form>
        {% else %}
            <p>Select a conversation to start messaging.</p>
        {% endif %}
    </div>
</div>
{% endblock %}



